<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hopsan: How to setup the Hopsan build environment</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="hopsan.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hopsan
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_setupbuildenvironment.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">How to setup the Hopsan build environment </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Hopsan build environment is centered around the QtCreator IDE and uses qmake project files and the qmake program to generate Makefiles. HopsanGUI and some other components require the Qt libraries but some components such as the HospanCore library are written in "Plain C++". This means that it is possible to build the core components of Hopsan without Qt if that would be needed. On Windows the MinGW-W64 compiler is used/expected by default. While it should be possible to use the Microsoft compiler as well this has not been tested for building all of Hopsan. It is possible, however, to build the HopsanCore and component libraries with the Microsoft compiler. See <a class="el" href="page_setupbuildenvironmentmsvc.html">Setting up the MSVC++ (The Microsoft Visual C++ Compiler) environment</a> for more information about setting up the MSVC compiler.</p>
<p>We are using the mingw-builds version of the MinGW-w64 compiler project from (<a href="http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/">http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/</a>) and a custom-built version of the Qt libraries for this compiler.</p>
<h1><a class="anchor" id="sec_setupbuildenvironment_windows"></a>
Development on Microsoft Windows</h1>
<p>From version 0.7 of Hopsan an onwards, 32-bit Windows versions are no longer supported by default. If you want one, you have to build it yourself. You need to find the appropriate compiler version and compile all dependencies yourself.</p>
<p><b>This guide is meant for Hopsan version 0.7.* 64-bit development</b> <br />
<b>You must use the same compiler version for all components of Hopsan and dependencies, if you mix versions, Hopsan may not work as expected!</b></p>
<p>It is important that you install to the exact destinations given below, otherwise the automatic scripts for building dependencies will not work. If you want to use an other destination you can, of course, edit the scripts. In particular, see the <code>setupHopsanBuildPaths.bat/sh</code> script.</p>
<p>You may need to install the 7-Zip program from <a href="http://www.7-zip.org">http://www.7-zip.org</a> to unpack the needed files</p>
<p><b>Installing the compiler:</b></p><ol type="1">
<li>Download "x86_64-4.9.3-release-posix-seh-rt_v4-rev1.7z" from <a href="http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/4.9.3/threads-posix/seh/x86_64-4.9.3-release-posix-seh-rt_v4-rev1.7z">http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/4.9.3/threads-posix/seh/x86_64-4.9.3-release-posix-seh-rt_v4-rev1.7z</a></li>
<li>Unpack to <code>C:\Qt\x86_64-4.9.3-release-posix-seh-rt_v4-rev1</code></li>
</ol>
<p><b>Installing the Qt libraries:</b></p><ol type="1">
<li>Download our custom-built Qt version from <a href="http://flumes.iei.liu.se/hopsan/files/development_files/0.7.x_64bit/qt-5.4.2-x64-mingw493r4-seh-rev1.7z">http://flumes.iei.liu.se/hopsan/files/development_files/0.7.x_64bit/qt-5.4.2-x64-mingw493r4-seh-rev1.7z</a></li>
<li>Unpack to <code>C:\Qt\qt-5.4.2-x64-mingw493r4-seh-rev1</code></li>
<li>Enter the directory and run the <code>qtbinpatcher.exe</code> program to correct all qt paths</li>
</ol>
<p><b>Installation of the Qt Creator IDE:</b></p><ol type="1">
<li>Download and install <b>Qt Creator</b> from <a href="http://download.qt.io/official_releases/qtcreator/">http://download.qt.io/official_releases/qtcreator/</a> <br />
<b>Note!</b> Make sure that you <b>ONLY</b> install Qt Creator, and <b>NOT</b> the official Qt Libraries! <br />
<b>Note!</b> A 32-bit version of Qt Creator will work fine even if you are building 64-bit, it is only the code editor.</li>
</ol>
<p><b>Configure QtCreator:</b></p><ol type="1">
<li>In QtCreator, go to Tools-&gt;Options-&gt;Build&amp;Run</li>
<li>Under the tab "Qt Versions", add your "Qt Version" (if it does not exist) by pointing to <code>C:\Qt\qt-5.4.2-x64-mingw493r4-seh-rev1\bin\qmake.exe</code> <br />
 Select a clever name so that you know which Qt version is which (if you multiple versions installed)</li>
<li>Make sure that the compiler is configured under "Compilers", add it manually has not been found, (point to <code>C:\Qt\x86_64-4.9.3-release-posix-seh-rt_v4-rev1\mingw64\bin\g++.exe</code> ) <br />
 Make sure to select a clever name (if you are using multiple compilers) so that you can easily identify them. <br />
 Make sure that the ABI: field shows: <b>x86-windows-msys-pe-64bit</b></li>
<li>Configure a debugger under the Debuggers tab by pointing to <code>C:\Qt\x86_64-4.9.3-release-posix-seh-rt_v4-rev1\mingw64\bin\gdb.exe</code> <br />
 Make sure to select a clever name (if you are using multiple debuggers) so that you can easily identify them. <br />
</li>
<li>Configure a "Kit" (Combination of Qt version, Compiler and Debugger) under the Kits tab. <br />
 Again! Choose a clever name. <br />
 Choose Compiler, Debugger and Qt version in the drop down boxes. Make sure that the Qt mkspec: field is empty</li>
<li>If you plan to use the debugger, you may need to go to Tools-&gt;Options-&gt;Debugger-&gt;GDB and add <code>handle SIGTRAP nostop print</code> under "Additional Startup Commands". This will prevent the debugger from stopping to often.</li>
</ol>
<h2><a class="anchor" id="sec_setupbuildenvironment_tools"></a>
External Build Tools</h2>
<p>To build some of the dependencies some additional external build tools are required. You may not need these if you are not building all dependencies.</p>
<p><b>Install CMake:</b></p><ol type="1">
<li>Install CMake from <a href="http://www.cmake.org/">http://www.cmake.org/</a> and install it to the default location.</li>
</ol>
<p><b>Install MSYS2:</b> This is a short guide: you can find more instructions at <a href="http://msys2.github.io/">http://msys2.github.io/</a> and <a href="http://sourceforge.net/p/msys2/wiki/MSYS2%20installation/">http://sourceforge.net/p/msys2/wiki/MSYS2%20installation/</a></p>
<ol type="1">
<li>Download the installer from <a href="http://msys2.github.io/">http://msys2.github.io/</a> Choose the x86_64 version on 64-bit Windows</li>
<li>Install it to the default location (<code>c:\msys64\</code>) (or change the path in the <code>setupHopsanPaths</code> script later on.</li>
<li>Start msys2 (MSYS2 Shell) and update the core components by running the command: <code>pacman --needed -Sy bash pacman pacman-mirrors msys2-runtime</code></li>
<li><b>This step is VERY important!</b> Close msys2 (run <code>exit</code>). If the window does not close after "exit" then kill the bash.exe process manually.</li>
<li>Start msys2 again and run the following command to upgrade the remaning packages: <code>pacman -Su</code></li>
<li>To install the required build tools, run: <code>pacman -S make automake autoconf libtool pkgconfig patch</code></li>
</ol>
<h1><a class="anchor" id="sec_setupbuildenvironment_ubuntu"></a>
Development on GNU/Linux *Ubuntu or any Debian based system</h1>
<p>On Linux based operating systems you should use the default GCC compiler. You should use the Qt-libraries in you distribution package repository. Make sure that you install the Qt development packages.</p>
<ol type="1">
<li>To install GCC (and some other tools) on Ubuntu run <code>apt-get install build-essential</code>.</li>
<li>The following packages seem to include all necessary components: <code>apt-get install python-dev, qtbase5-dev, libqt5webkit5-dev, libqt5svg5-dev, qtmultimedia5-dev, libqt5opengl5-dev, libhdf5-dev, unzip, cmake, libtool-bin, automake, pkg-config</code><br />
 <b>Note!</b> What packages are needed may change between OS versions (due to repackaging), you may need additional packages.</li>
<li>Download Qt Creator from your package repository or a newer version from <a href="http://download.qt.io/official_releases/qtcreator/">http://download.qt.io/official_releases/qtcreator/</a> <br />
</li>
</ol>
<h2><a class="anchor" id="qt4-linux-gcc"></a>
Installing Qt4 (If Qt5 is not available)</h2>
<p>If Qt5 libraries are not available you will need the following packages instead: <code>apt-get install python-dev, libqt4-dev, libqtwebkit-dev, libhdf5-dev, unzip, cmake, libtool, automake, pkg-config</code>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Sep 16 2019 10:42:36 for Hopsan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
