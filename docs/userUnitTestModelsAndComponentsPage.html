<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hopsan: Model and Component Unit-Testing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="hopsan.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hopsan
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('userUnitTestModelsAndComponentsPage.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Model and Component Unit-Testing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>When you have finished a component and/or model and you are satisfied with the simulation results you can save you model and some of the simulation results as a test model. You can later run this model again and automatically compare the simulation results. This is very important if you want to make sure that your component and models do not change their behaviour when new versions of Hopsan are released. <b>Remember</b> that you can not make any more changes (that affect simulation results) to the model file if you want the validation to match.</p>
<h1><a class="anchor" id="userUnitTestModelsAndComponentsPage-components_howtocreateCLI"></a>
How to Create a Validation Model in Hopsan CLI</h1>
<p>The HopsanCLI can automatically create a validation data set based on all scopes in your model. If no scopes are available, no data set will be created.</p><ol type="1">
<li>Use the HopsanCLI (Hopsan CommandLineInterface) with the -m and &ndash;createValidationData switches according to the following examples:<br />
 The -d (destination directory) switch is optional<ol type="a">
<li>Windows: hopsancli.exe -m pathto\ExampleModel.hmf &ndash;createValidationData -d outputDirectoryPath</li>
<li>Ubuntu: ./hopsancli -m pathto/ExampleModel.hmf &ndash;createValidationData -d outputDirectoryPath</li>
</ol>
</li>
<li>Store the model, dataset and hvc file in a safe place.</li>
</ol>
<h1><a class="anchor" id="userUnitTestModelsAndComponentsPage-components_howtocreateGUI"></a>
How to Create a Validation Model in Hopsan GUI</h1>
<ol type="1">
<li>Open your model in HopsanGUI and simulate it.<ol type="a">
<li>Add the variables (from ports) that you want to use as validation data to a plot window.</li>
<li>Export the data as <b>hvc</b>, <b>hvd</b> (Hopsan Validation Configuration and Data) files.</li>
</ol>
</li>
<li>The generated <b>hvc</b> file contains default entries. You may want to manually edit it, see format description below.</li>
<li>Store the model, dataset and hvc file in a safe place.</li>
</ol>
<h1><a class="anchor" id="userUnitTestModelsAndComponentsPage-components_howtotestCLI"></a>
How to Test a Validation Model in Hopsan CLI</h1>
<ol type="1">
<li>Use the HopsanCLI (Hopsan CommandLineInterface) with the -t (for test) switch according to:<ol type="a">
<li>Windows: hopsancli.exe -t "MyHVCFile.hvc"</li>
<li>Ubuntu: ./hopsancli -t "MyHVCFile.hvc"</li>
</ol>
</li>
<li>If you want to automatically test multiple models, then you should write a script that goes through all of your hvc files.</li>
</ol>
<h1><a class="anchor" id="userUnitTestModelsAndComponentsPage-components_howtotestGUI"></a>
How to Test a Validation Model in Hopsan GUI</h1>
<ol type="1">
<li>Open the Model Validation Widget in the <b>Tools</b> menu.<ol type="a">
<li>Load your Hopsan Validation Configuration <b>.hvc</b> file. The widget will show you what variables will be tested.</li>
<li><em>Note!</em> The widget is not yet fully implemented but you can compare data</li>
<li>Click the compare button to simulate the model and generate plots comparing the data. You must manually check the data to make sure that the simulated result is the same as the validation data.</li>
</ol>
</li>
</ol>
<h1><a class="anchor" id="userUnitTestModelsAndComponentsPage-components_hvc-format"></a>
The HVC (Hopsan Validation Configuration) Format</h1>
<p>This is an example HVC File. Note that you can have multiple &lt;validation&gt; and &lt;variable&gt; tags to perform multiple tests from the same configuration file.</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;hopsanvalidationconfiguration hvcversion="0.2"&gt;
    &lt;validation hopsancliversion="0.6.x_r6964" time="141140" date="20140430" hopsancoreversion="0.6.x_r6964"&gt;
        &lt;!--Optional path to model file, if not specified the same name (excluding suffix) and path as this file will be used--&gt;
        &lt;modelfile&gt;../Example Models/Position Servo.hmf&lt;/modelfile&gt;
        &lt;!--&lt;parameterset&gt;Not yet supported!&lt;/parameterset&gt;--&gt;
        &lt;!--Optional path to Hopsan validation data file, if not specified the same name (excluding suffix) and path as this file will be used--&gt;
        &lt;hvdfile&gt;Position Servo.hvd&lt;/hvdfile&gt;
        &lt;!-- The name attribute contains the full name including subsystem hierarchy. Ex: System$Subsystem$Component#Port#Variable --&gt;
        &lt;variable name="Position_Servo$Position_Sensor#out#Value"&gt;
            &lt;!--The time column in the hvd file for this variable. Column indexing begins at 0--&gt;
            &lt;timecolumn&gt;0&lt;/timecolumn&gt;
            &lt;!--The data column in the hvd file for this variable. Column indexing begins at 0--&gt;
            &lt;column&gt;1&lt;/column&gt;
            &lt;!--Tolerance, allowed deviation 0.01==1%--&gt;
            &lt;tolerance&gt;0.01&lt;/tolerance&gt;
        &lt;/variable&gt;
        &lt;variable name="Position_Servo$Step#out#Value"&gt;
            &lt;timecolumn&gt;0&lt;/timecolumn&gt;
            &lt;column&gt;2&lt;/column&gt;
            &lt;tolerance&gt;0.01&lt;/tolerance&gt;
        &lt;/variable&gt;
        &lt;variable name="Position_Servo$4_3_Servo_Valve#xv#Value"&gt;
            &lt;timecolumn&gt;0&lt;/timecolumn&gt;
            &lt;column&gt;3&lt;/column&gt;
            &lt;tolerance&gt;0.01&lt;/tolerance&gt;
        &lt;/variable&gt;
        &lt;variable name="Position_Servo$Pressure_Relief_Valve#xv#Value"&gt;
            &lt;timecolumn&gt;0&lt;/timecolumn&gt;
            &lt;column&gt;4&lt;/column&gt;
            &lt;tolerance&gt;0.01&lt;/tolerance&gt;
        &lt;/variable&gt;
    &lt;/validation&gt;
&lt;/hopsanvalidationconfiguration&gt;
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Sep 16 2019 10:42:36 for Hopsan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
